/**
 * server.js íŒŒì¼ì— ì„¹ì…˜ ì£¼ì„ì„ ì¶”ê°€í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
 * ê¸°ì¡´ ì½”ë“œëŠ” ì „í˜€ ìˆ˜ì •í•˜ì§€ ì•Šê³  ì£¼ì„ë§Œ ì¶”ê°€í•©ë‹ˆë‹¤.
 */

const fs = require('fs');
const path = require('path');

const inputFile = path.join(__dirname, '..', 'server.251128.js');
const outputFile = path.join(__dirname, '..', 'server.js');

console.log('ğŸ“‹ server.jsì— ì„¹ì…˜ ì£¼ì„ ì¶”ê°€ ì‹œì‘...');

// ì›ë³¸ íŒŒì¼ ì½ê¸°
const content = fs.readFileSync(inputFile, 'utf8');
const lines = content.split('\n');

console.log(`âœ… ì´ ${lines.length}ì¤„ ì½ìŒ`);

// ì£¼ì„ì„ ì¶”ê°€í•  ìœ„ì¹˜ì™€ ë‚´ìš© ì •ì˜
const sectionComments = [
  {
    line: 0,
    comment: [
      '// =============================================================================',
      '// Sales Management API Server - ë©”ë‰´ë³„ êµ¬ì¡°',
      '// =============================================================================',
      '// ì°¸ê³ : SERVER_STRUCTURE.md íŒŒì¼ì—ì„œ ì „ì²´ êµ¬ì¡° í™•ì¸ ê°€ëŠ¥',
      '// =============================================================================',
      ''
    ]
  },
  {
    line: 222, // ì¸ì¦ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 2. ì¸ì¦/ì‚¬ìš©ì ê´€ë¦¬',
      '// =============================================================================',
      '// - POST /api/auth/login, /api/auth/logout',
      '// - GET  /api/auth/me, POST /api/auth/heartbeat',
      '// =============================================================================',
      ''
    ]
  },
  {
    line: 484, // ì‚¬ì—…ì¥ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 3. ê¸°ì¤€ì •ë³´ ê´€ë¦¬',
      '// =============================================================================',
      '',
      '// -----------------------------------------------------------------------------',
      '// 3.1 ì‚¬ì—…ì¥ ê´€ë¦¬',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 593, // ë§¤ì¶œì²˜ ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 3.2 ë§¤ì¶œì²˜ ê´€ë¦¬ (ê³ ê°)',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 968, // ë§¤ì…ì²˜ ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 3.3 ë§¤ì…ì²˜ ê´€ë¦¬ (ê³µê¸‰ì—…ì²´)',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 1675, // ê³„ì •ê³¼ëª© ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 3.4 ê³„ì •ê³¼ëª© ê´€ë¦¬',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 1895, // ê²¬ì ì„œ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 4. ë§¤ì¶œ ê´€ë¦¬',
      '// =============================================================================',
      '',
      '// -----------------------------------------------------------------------------',
      '// 4.1 ê²¬ì ì„œ ê´€ë¦¬',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 2625, // ë°œì£¼ì„œ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 5. ë§¤ì… ê´€ë¦¬',
      '// =============================================================================',
      '',
      '// -----------------------------------------------------------------------------',
      '// 5.1 ë°œì£¼ì„œ ê´€ë¦¬',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 3122, // ìì¬ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 6. ìì¬ ê´€ë¦¬',
      '// =============================================================================',
      ''
    ]
  },
  {
    line: 4271, // ê±°ë˜ëª…ì„¸ì„œ ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 4.2 ê±°ë˜ëª…ì„¸ì„œ ê´€ë¦¬ (ë§¤ì¶œ)',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 5521, // ì„¸ê¸ˆê³„ì‚°ì„œ ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 4.3 ì„¸ê¸ˆê³„ì‚°ì„œ ê´€ë¦¬',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 6307, // ë§¤ì…ì „í‘œ ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 5.2 ë§¤ì…ì „í‘œ ê´€ë¦¬',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 7008, // ë¯¸ì§€ê¸‰ê¸ˆ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 8. ì¥ë¶€ ê´€ë¦¬',
      '// =============================================================================',
      '',
      '// -----------------------------------------------------------------------------',
      '// 8.1 ë¯¸ì§€ê¸‰ê¸ˆ ê´€ë¦¬ (ë§¤ì…ì²˜ ì¥ë¶€)',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 7174, // ë¯¸ìˆ˜ê¸ˆ ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 8.2 ë¯¸ìˆ˜ê¸ˆ ê´€ë¦¬ (ë§¤ì¶œì²˜ ì¥ë¶€)',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 7399, // ëŒ€ì‹œë³´ë“œ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 9. ëŒ€ì‹œë³´ë“œ/ë¦¬í¬íŠ¸',
      '// =============================================================================',
      ''
    ]
  },
  {
    line: 7640, // ê³„ì •ë¶„ë¥˜ ì‹œì‘
    comment: [
      '',
      '// =============================================================================',
      '// 7. íšŒê³„ ê´€ë¦¬',
      '// =============================================================================',
      '',
      '// -----------------------------------------------------------------------------',
      '// 7.1 ê³„ì •ë¶„ë¥˜',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  },
  {
    line: 7666, // í˜„ê¸ˆì¶œë‚©ì¥ ì‹œì‘
    comment: [
      '',
      '// -----------------------------------------------------------------------------',
      '// 7.2 í˜„ê¸ˆì¶œë‚©ì¥ ê´€ë¦¬',
      '// -----------------------------------------------------------------------------',
      ''
    ]
  }
];

// ì£¼ì„ ì¶”ê°€ (ë’¤ì—ì„œë¶€í„° ì²˜ë¦¬í•˜ì—¬ ë¼ì¸ ë²ˆí˜¸ ë³€í™” ë°©ì§€)
sectionComments.sort((a, b) => b.line - a.line);

let output = [...lines];
sectionComments.forEach(({ line, comment }) => {
  output.splice(line, 0, ...comment);
});

// íŒŒì¼ ì €ì¥
const finalContent = output.join('\n');
fs.writeFileSync(outputFile, finalContent, 'utf8');

console.log('');
console.log('âœ… ì„¹ì…˜ ì£¼ì„ ì¶”ê°€ ì™„ë£Œ!');
console.log(`ğŸ“ ì¶œë ¥ íŒŒì¼: ${outputFile}`);
console.log(`ğŸ“ ì´ ì¤„ ìˆ˜: ${output.length}ì¤„ (ì¶”ê°€ëœ ì£¼ì„: ${output.length - lines.length}ì¤„)`);
console.log('');
console.log('âœ… ë‹¤ìŒ ë‹¨ê³„: ì„œë²„ ì‹œì‘ í…ŒìŠ¤íŠ¸');
console.log('   npm start');
